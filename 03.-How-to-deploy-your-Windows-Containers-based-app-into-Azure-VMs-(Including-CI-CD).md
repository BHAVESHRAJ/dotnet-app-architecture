##  Overview
Deploying to a Docker host on a Windows Server 2016 VM in Azure allows you to have quick dev/test/staging environments where you can run your applications in a common place for testers or business users validating the app. VMs can also be valid for IaaS production environments.

##  Goals for this walkthrough
This walkthrough shows you the multiple alternatives you can have when deploying Windows Containers to Azure VMs based on Windows Server 2016 or later.

## Introduction to Azure VMs for Windows Containers
Virtual Machines for Windows containers are simply VMs based on Windows Server 2016, Windows 10, or later versions, both with Docker engine setup. Usually, you will use Windows Server2016 in the Azure VMs.
**Azure currently provides a VM named “Windows Server 2016 with Containers”** which allows you to try the new Windows Server Container feature with both Windows Server Core and Windows Nano Server Container OS Images installed and ready to use with Docker.

##  Scenarios
There are several scenarios. The following diagrams show you each of them to be detailed in this page.

**SCENARIO A:**
![image](https://user-images.githubusercontent.com/1712635/30402751-b976ac40-9893-11e7-9666-de94de842d31.png)

**SCENARIO B:**
![image](https://user-images.githubusercontent.com/1712635/30402804-d62632a2-9893-11e7-817a-f9f616cdf380.png)

**SCENARIO C:**
![image](https://user-images.githubusercontent.com/1712635/30403848-692350f4-9898-11e7-881a-e302f7fc7385.png)

## Prerequisites
- A Microsoft Azure subscription. If you don't have one, sign up for a free trial [here](https://azure.microsoft.com/en-us/free/).
- Dev machine with Windows 10, Docker for Windows and Visual Studio 2017

## Benefits when using Azure VM for Windows Containers Docker host
Although Windows Containers can be deployed into on-premises Windows Server 2016 VMs, however, when deploying into Azure you get a much easier way to get started with ready-to-use Windows Server Container VMs, a common place in the Internet accessible for testers plus automatic scalability of VMs through Azure scale-sets.

## Deploying a Windows Server 2016 VM in Azure (for Windows Containers)

As mentioned, before starting the walkthrough, you will need an Azure subscription account. If you don’t already have one, sign up for a free 30-day trial here.

### Deploy the Virtual Machine in Azure
First of all, log in to the Azure management portal. Then, click on the “+ New” menu option and then search for **“Windows Server 2016 Datacenter - with Containers”** and select that VM type, as shown in the image below.

![image](https://user-images.githubusercontent.com/1712635/30406957-3215bc20-98aa-11e7-8602-5cdae6f7e523.png)

On the Windows Server 2016 Datacenter – with Containers panel, make sure that Resource Manager is selected in the Select a Deployment Model drop-down menu. Then, click on the “Create” button, as specified in the next image.

![image](https://user-images.githubusercontent.com/1712635/30406974-5238cc04-98aa-11e7-9bdb-0a3be3a9e0af.png)

Then, you will see a panel with the VM settings that you need to select or write as shown in the following screenshot.

![image](https://user-images.githubusercontent.com/1712635/30406999-6d125cc0-98aa-11e7-8681-a6c90a77d6a9.png)

On the Create Virtual Machine panel and within the Basics tab, provide a name for the server, a username for the VM’s administrator account in the User field, type and confirm a password for the account, and finally in the Resource Group field, make sure that Create new is checked, and type a name for the new Resource Group.

Change the Datacenter Location using the drop-down menu, if needed. Finally, hit OK.

In the Choose a size panel set a size for the new VM and hit Select. 

![image](https://user-images.githubusercontent.com/1712635/30407011-8a275db0-98aa-11e7-9b49-8300f1a43464.png)

In the Settings panel, under Storage, set Use Managed Disks to Yes. 
You will also need to create a new Virtual Network (or select an existing one), as in the next image.

![image](https://user-images.githubusercontent.com/1712635/30407029-ab66a8d2-98aa-11e7-8e5a-c1ced1834745.png)

Then, click on OK at the bottom of the Settings panel and finally hit the OK button of the Summary panel to deploy the VM.
The deployment will take a few minutes.

### Connect to the Windows Server 2016 VM using RDP
Once the VM is deployed, you can enter into its configuration panel in Azure portal. Follow the following steps once you are in the VM configuration panel.

- In the Virtual Machine panel, click Connect to open an RDP session to the VM.
- Save the RDP file to your PC and open it by double-clicking on it.
- Click Connect in the Remote Desktop Connection dialog box, as shown in image X-XX.





## Deploying from VSTS CD pipeline to Azure VM 
- TBD (Plain)